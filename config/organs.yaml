# Smart Habitat Organism Configuration (SeedCore v2)
# ---------------------------------------------------
# Defines the organs of the Habitat AI Organism.
# Each organ represents an autonomous subsystem composed of specialized agent clusters.

seedcore:
  organism:
    # --- Returned as 'global_settings' ---
    settings:
      tunnel_threshold: 0.85
      tunnel_intents: ["clarify", "debug"]

    organs:
      # =============================================================
      #  CORE ORGANS (Minimal Essential Configuration)
      # =============================================================
      # Note: Additional agents are dynamically spawned from pkg_subtask_types
      # via CapabilityMonitor. Static config here is for baseline initialization only.
      
      - id: "user_experience_organ"
        description: "User dialog and interaction."
        agents:
          - specialization: "USER_LIAISON"
            class: "BaseAgent"
            behaviors: ["chat_history", "tool_auto_injection"]
            behavior_config:
              chat_history:
                limit: 50
              tool_auto_injection:
                auto_add_general_query: true
            count: 1

      - id: "environment_intelligence_organ"
        description: "World modeling and anomaly detection."
        agents:
          - specialization: "ENVIRONMENT"
            class: "BaseAgent"
            behaviors: ["background_loop", "task_filter"]
            behavior_config:
              background_loop:
                interval_s: 10.0
                method: "sense_environment"
                max_errors: 3
              task_filter:
                allowed_types: ["env.tick", "environment.tick"]
            count: 1
          - specialization: "ANOMALY_DETECTOR"
            class: "BaseAgent"
            behaviors: ["background_loop", "task_filter"]
            behavior_config:
              background_loop:
                interval_s: 10.0
                method: "sense_environment"
                max_errors: 3
              task_filter:
                allowed_types: ["env.tick", "environment.tick"]
            count: 1

      - id: "orchestration_organ"
        description: "Device control and coordination."
        agents:
          - specialization: "DEVICE_ORCHESTRATOR"
            class: "BaseAgent"
            behaviors: ["background_loop", "task_filter", "tool_registration", "dedup", "safety_check"]
            behavior_config:
              background_loop:
                interval_s: 5.0
                method: "control_tick"
                max_errors: 5
              task_filter:
                allowed_types: ["orchestration.tick", "orchestration.enqueue_commands", "orchestration.device_command", "orchestration.robot_task", "orchestration.energy_optimize", "action"]
              tool_registration:
                tools: ["tuya.send_command", "robots.assign_task", "energy.optimize"]
              dedup:
                ttl_s: 60.0
              safety_check:
                enabled: true
            count: 1

      - id: "robot_execution_organ"
        description: "Physical robot execution."
        agents:
          - specialization: "CLEANING_ROBOT"
            count: 1

      - id: "verification_organ"
        description: "Result verification and QA."
        agents:
          - specialization: "RESULT_VERIFIER"
            count: 1

      - id: "learning_organ"
        description: "Continuous learning and adaptation."
        agents:
          - specialization: "CRITIC"
            count: 1
          - specialization: "ADAPTIVE_LEARNER"
            count: 1

      - id: "utility_organ"
        description: "Utility and observation agents."
        agents:
          - specialization: "OBSERVER"
            class: "BaseAgent"
            behaviors: ["background_loop", "task_filter"]
            behavior_config:
              background_loop:
                interval_s: 2.0
                method: "_proactive_pass"
              task_filter:
                allowed_types: ["observer.proactive_cache", "observer.observe"]
            count: 1
          - specialization: "UTILITY"
            class: "UtilityAgent"
            count: 1
          - specialization: "GENERALIST"
            count: 1

    # =============================================================
    #  2. FUNCTIONAL LAYER — VIRTUAL NETWORK OVERLAY (ENERGY BONDS)
    # =============================================================

    topology:
      # Minimal topology configuration
      # Additional bonds are dynamically discovered from agent interactions
      
      # Cross-Organ Integration Bonds
      cross_organ_bonds:
        - agents: ["USER_LIAISON", "DEVICE_ORCHESTRATOR"]
          weight: 0.7
          description: "User → device execution loop"

      # Learning-driven bonds
      learned_bonds:
        - agents: ["CRITIC", "ADAPTIVE_LEARNER"]
          weight: 0.65
          description: "Reinforcement-learning policy update"

      # Global defaults
      defaults:
        min_weight_threshold: 0.1
        symmetry: true
        max_partners: 4
        seed_missing_agents: true
